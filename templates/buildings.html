{% extends 'base.html' %}
{% load static %}

{% block title %}Qu·∫£n l√Ω T√≤a nh√†{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/buildings.css' %}">
{% endblock %}

{% block header_icon %}<i class="fa-solid fa-city"></i>{% endblock %}
{% block header_title %}Qu·∫£n l√Ω T√≤a nh√†{% endblock %}

{% block content %}
<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-title">T·ªïng t√≤a nh√†</div>
        <div class="stat-value">{{ buildings.count }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-title">ƒêang ho·∫°t ƒë·ªông</div>
        <div class="stat-value" style="color: var(--status-empty);">{{ active_count|default:"0" }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-title">Ng·ª´ng ho·∫°t ƒë·ªông</div>
        <div class="stat-value" style="color: var(--status-occupied);">{{ inactive_count|default:"0" }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-title">T·ªïng ph√≤ng</div>
        <div class="stat-value">{{ total_rooms|default:"0" }}</div>
    </div>
</div>

<!-- Filters & Actions -->
<div class="section-header">
    <div class="filters">
        <select id="filter-status" class="filter-select" onchange="applyFilters()">
            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
            <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
            <option value="inactive">Ng·ª´ng ho·∫°t ƒë·ªông</option>
        </select>
        
        <input type="text" id="search-input" class="search-input" 
               placeholder="üîç T√¨m t√™n t√≤a nh√†, m√£..." 
               onkeypress="if(event.key==='Enter') applyFilters()">
        
        <button class="btn-secondary" onclick="applyFilters()" style="padding: 10px 16px;">
            <i class="fa-solid fa-search"></i>
        </button>
    </div>
    
    <button class="btn-primary" onclick="openAddModal()">
        <i class="fa-solid fa-plus"></i> Th√™m t√≤a nh√†
    </button>
</div>

<!-- Buildings Grid -->
<div class="buildings-grid">
    {% if buildings %}
        {% for building in buildings %}
        <div class="building-card" onclick="viewBuilding('{{ building.building_id }}')">
            <div class="building-header">
                <div class="building-icon">
                    <i class="fa-solid fa-building"></i>
                </div>
                <div class="building-status">
                    {% if building.status == 'active' %}
                        <span class="status-badge status-active">ƒêang ho·∫°t ƒë·ªông</span>
                    {% else %}
                        <span class="status-badge status-inactive">Ng·ª´ng ho·∫°t ƒë·ªông</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="building-info">
                <h3 class="building-name">{{ building.name }}</h3>
                <p class="building-id">M√£: {{ building.building_id }}</p>
                <p class="building-address">
                    <i class="fa-solid fa-location-dot"></i> {{ building.address|truncatewords:10 }}
                </p>
            </div>
            
            <div class="building-stats">
                <div class="stat-item">
                    <i class="fa-solid fa-layer-group"></i>
                    <span>{{ building.total_floors|default:"0" }} t·∫ßng</span>
                </div>
                <div class="stat-item">
                    <i class="fa-solid fa-door-open"></i>
                    <span>{{ building.total_rooms|default:"0" }} ph√≤ng</span>
                </div>
                <div class="stat-item">
                    <i class="fa-solid fa-check-circle"></i>
                    <span>{{ building.total_availble_rooms|default:"0" }} tr·ªëng</span>
                </div>
            </div>

            <!-- Filters & Actions -->
            <!-- <div class="section-header">
                <div class="filters">
                    <select id="filter-status" class="filter-select" onchange="applyFilters()">
                        <option value="" {% if not request.GET.status %}selected{% endif %}>
                            T·∫•t c·∫£ tr·∫°ng th√°i
                        </option>

                        <option value="active" {% if request.GET.status == 'active' %}selected{% endif %}>
                            ƒêang ho·∫°t ƒë·ªông
                        </option>

                        <option value="inactive" {% if request.GET.status == 'inactive' %}selected{% endif %}>
                            Ng·ª´ng ho·∫°t ƒë·ªông
                        </option>
                    </select>
                    
                    <input type="text" name="q" id="search-input" class="search-input" 
                           placeholder="T√¨m t√™n t√≤a nh√†, m√£..." 
                           onkeypress="if(event.key==='Enter') applyFilters()">
                    
                    <button class="btn-secondary" onclick="applyFilters()" style="padding: 10px 16px;">
                        <i class="fa-solid fa-search"></i>
                    </button>
                </div>
                
                <button class="btn-primary" onclick="openAddModal()">
                    <i class="fa-solid fa-plus"></i> Th√™m t√≤a nh√†
                </button>
            </div> -->
        </div>
        {% endfor %}
    {% else %}
        <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #999;">
            <i class="fa-solid fa-inbox" style="font-size: 48px; margin-bottom: 16px;"></i><br>
            Ch∆∞a c√≥ t√≤a nh√† n√†o
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/buildings.js' %}"></script>
{% endblock %}
