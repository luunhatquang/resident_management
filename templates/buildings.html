{% extends 'base.html' %}
{% load static %}

{% block title %}Qu·∫£n l√Ω T√≤a nh√†{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/buildings.css' %}">
{% endblock %}

{% block header_icon %}<i class="fa-solid fa-city"></i>{% endblock %}
{% block header_title %}Qu·∫£n l√Ω T√≤a nh√†{% endblock %}

{% block content %}
<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card" style="border-top: 4px solid var(--primary-color);">
        <div class="stat-title">
            <i class="fa-solid fa-city" style="color: var(--primary-color); margin-right: 5px;"></i> T·ªïng t√≤a nh√†
        </div>
        <div class="stat-value">{{ buildings.count }}</div>
    </div>
    <div class="stat-card" style="border-top: 4px solid #10b981;">
        <div class="stat-title">
            <i class="fa-solid fa-circle-check" style="color: #10b981; margin-right: 5px;"></i> ƒêang ho·∫°t ƒë·ªông
        </div>
        <div class="stat-value" style="color: #10b981;">{{ active_count|default:"0" }}</div>
    </div>
    <div class="stat-card" style="border-top: 4px solid #ef4444;">
        <div class="stat-title">
            <i class="fa-solid fa-circle-xmark" style="color: #ef4444; margin-right: 5px;"></i> Ng·ª´ng ho·∫°t ƒë·ªông
        </div>
        <div class="stat-value" style="color: #ef4444;">{{ inactive_count|default:"0" }}</div>
    </div>
    <div class="stat-card" style="border-top: 4px solid #f59e0b;">
        <div class="stat-title">
            <i class="fa-solid fa-door-closed" style="color: #f59e0b; margin-right: 5px;"></i> T·ªïng ph√≤ng
        </div>
        <div class="stat-value" style="color: #f59e0b;">{{ total_rooms|default:"0" }}</div>
    </div>
</div>

<!-- Filters & Actions -->
<div class="section-header">
    <div class="filters">

        <select id="filter-status" class="filter-select" onchange="applyFilters()">
    
            <option value="" {% if not request.GET.status %}selected{% endif %}>
                T·∫•t c·∫£ tr·∫°ng th√°i
            </option>
            
            <option value="active" {% if request.GET.status == 'active' %}selected{% endif %}>
                ƒêang ho·∫°t ƒë·ªông
            </option>
            
            <option value="inactive" {% if request.GET.status == 'inactive' %}selected{% endif %}>
                Ng·ª´ng ho·∫°t ƒë·ªông
            </option>

        </select>
        

        <input type="text" 
            id="search-input" class="search-input"
            placeholder="üîç T√¨m t√™n t√≤a nh√†, m√£..." 
            value="{{ request.GET.search|default:'' }}" 
            onkeypress="if(event.key==='Enter') applyFilters()">
        
        <button class="btn-secondary" onclick="applyFilters()" style="padding: 10px 16px;">
            <i class="fa-solid fa-search"></i>
        </button>
    </div>
    
    <button class="btn-primary" onclick="openAddModal()" style="height: 42px; padding: 0 24px; font-weight: 600;">
        <i class="fa-solid fa-plus"></i> Th√™m t√≤a nh√†
    </button>
</div>

<!-- Buildings Grid -->
<div class="buildings-grid">
    {% if buildings %}
        {% for building in buildings %}
        <div class="building-card" onclick="viewBuilding('{{ building.building_id }}')">
            <div class="building-header">
                <div class="building-icon">
                    <i class="fa-solid fa-building"></i>
                </div>
                <div class="building-status">
                    {% if building.status == 'active' %}
                        <span class="status-badge status-active">ƒêang ho·∫°t ƒë·ªông</span>
                    {% else %}
                        <span class="status-badge status-inactive">Ng·ª´ng ho·∫°t ƒë·ªông</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="building-info">
                <h3 class="building-name">{{ building.name }}</h3>
                <p class="building-id">M√£: {{ building.building_id }}</p>
                <p class="building-address">
                    <i class="fa-solid fa-location-dot"></i> {{ building.address|truncatewords:10 }}
                </p>
            </div>
            
            <div class="building-stats">
                <div class="stat-item">
                    <i class="fa-solid fa-layer-group" style="color: #6366f1;"></i>
                    <span style="font-weight: 600; color: var(--text-main);">{{ building.total_floors|default:"0" }}</span>
                    <span>T·∫ßng</span>
                </div>
                <div class="stat-item">
                    <i class="fa-solid fa-door-open"></i>
                    <span>{{ total_rooms|default:"0" }} ph√≤ng</span>
                </div>
                <div class="stat-item">
                    <i class="fa-solid fa-check-circle"></i>
                    <span>{{ total_availble_rooms|default:"0" }} tr·ªëng</span>
                </div>
            </div>
            <div class="building-actions">
                <button class="btn-icon" onclick="event.stopPropagation(); viewBuilding('{{ building.building_id }}')" title="Xem chi ti·∫øt">
                    <i class="fa-solid fa-eye"></i>
                </button>
                <button class="btn-icon" onclick="event.stopPropagation(); editBuilding('{{ building.building_id }}')" title="Ch·ªânh s·ª≠a">
                    <i class="fa-solid fa-edit"></i>
                </button>
            </div> -->
        </div>
        {% endfor %}
    {% else %}
        <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #999;">
            <i class="fa-solid fa-inbox" style="font-size: 48px; margin-bottom: 16px;"></i><br>
            Ch∆∞a c√≥ t√≤a nh√† n√†o
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/buildings.js' %}"></script>
{% endblock %}
